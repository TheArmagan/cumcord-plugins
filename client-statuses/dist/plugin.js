(function(D,b,E,w){"use strict";function p(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function T(e){if(e&&e.__esModule)return e;var a=Object.create(null);return e&&Object.keys(e).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(a,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}}),a.default=e,Object.freeze(a)}var o=p(D),l=p(b),x=p(E),C=T(w);class M{constructor(){this.patches=[]}add(...a){this.patches.push(...a)}remove(a){let[t]=this.patches.splice(this.patches.indexOf(r=>r==a),1);t()}removeAll(){let a=this.patches.splice(0,this.patches.length);for(let t=0;t<a.length;t++)a[t]()}}var d=new M;const v=o.default.findByProps("getAllApplicationActivities"),i=o.default.findByProps("createElement"),{useStateFromStores:O}=o.default.findByProps("useStateFromStores"),m={DANGER:"#eb3d47",SECONDARY:"#8a8e93",SUCCESS:"#3aa360",WARN:"#faa81a"},_={online:m.SUCCESS,dnd:m.DANGER,idle:m.WARN},I={desktop:o.default.findByDisplayName("Monitor"),mobile:o.default.findByDisplayName("MobileDevice"),web:o.default.findByDisplayName("Globe")},N={desktop:"Desktop",mobile:"Mobile",web:"Web",online:"Online",dnd:"Do Not Disturb",idle:"Idle"},{TooltipContainer:P}=o.default.findByProps("TooltipContainer");function u({userId:e}){let a=O([v],()=>Object.entries(v.getState()?.clientStatuses?.[e]||{}),[e]);return a?.length?i.createElement("div",{className:"cs--container"},a.map(([t,r])=>{let n=I[t];return i.createElement("div",{className:"cs--icon-container"},i.createElement(P,{text:`${N[r]} on ${N[t]}`,position:"top"},i.createElement(n,{style:{color:_[r]},className:"cs--icon"})))})):null}const{createElement:h,createContext:j}=i;function B(){const e=j(),a=o.default.find(s=>s?.default?.displayName==="AvatarWithText"),{default:t}=o.default.findByProps("DirectMessage"),r=l.default.after("render",t.prototype,function(s,c){return h(e.Provider,{value:this.props.user},c)}),n=l.default.before("default",a,([s])=>{s.decorators=[s.decorators,h(e.Consumer,{children:c=>c?h(u,{userId:c.id}):null})]});d.add(n,r)}const y=new Map;function R(e){const a=x.default.getReactInstance(e),t=[];let r=a;for(;r&&r.return&&typeof r.return.type!="string";)r.return.type&&t.push(r.return.type),r=r.return;return t}async function S(e=0){return new Promise(a=>setTimeout(a,e))}async function L(e,a){if(y.has(e))return y.get(e);let t;for(;;){const r=document.querySelectorAll(a);if(!r.length){await S(100);continue}for(const n of r)if(t=R(n).find(s=>s?.displayName==e),t)break;if(t)break;await S(100)}return y.set(e,t),t}const{createElement:$}=i;async function k(){const e=await L("MemberListItem",'[class*="member-"][class*="container-"]'),a=l.default.after("renderDecorators",e.prototype,function(t,r){try{const n=r?.props?.children;if(!Array.isArray(n))return;n.unshift($(u,{userId:this.props.user.id}))}catch(n){console.error("Error while patching MemberListItem:",n)}});d.add(a)}const{createElement:W}=i;function F(){const e=o.default.find(t=>t?.default?.displayName=="MessageHeader"),a=l.default.after("default",e,([t],r)=>{try{const n=r?.props?.username?.props?.children;if(!Array.isArray(n))return;n.splice(2,0,W(u,{userId:t.message.author.id}))}catch(n){console.error("Error while patching MessageTimestamp:",n)}});d.add(a)}const{createElement:g,createContext:G}=C;function U(){const e=G(),a=o.default.find(s=>s.default?.displayName==="DiscordTag"),t=o.default.find(s=>s.default?.displayName==="NameTag"),r=l.default.after("default",a,([{user:s}],c)=>g(e.Provider,{value:s},c)),n=l.default.after("default",t,([s],c)=>{const A=c?.props;if(Array.isArray(A.children)){try{A.children.push(g(e.Consumer,{children:f=>f?g(u,{userId:f.id}):null}))}catch(f){console.error(`Failed to inject into NameTag:
`,f)}return c}});d.add(r,n)}var H=()=>b.injectCSS(".cs--container{display:flex;width:min-width;padding:4px}.cs--icon-container{display:flex;align-items:center;justify-content:center}.cs--icon-container:not(:last-child){margin-right:2px}.cs--icon{display:flex;width:16px;height:16px}[class*=message-] [class*=headerText-],[class*=message-] h2[class*=header-],[class*=topSection-] [class*=nameTag-],[class*=headerTop-] [class*=nameTag-]{display:flex;align-items:center}[class*=topSection-] [class*=nameTag-] *,[class*=headerTop-] [class*=nameTag-] *{overflow:hidden}");function q(){const e=H();d.add(e)}var z={onLoad(){B(),k(),F(),U(),q()},onUnload(){d.removeAll()}};return z})(cumcord.modules.webpack,cumcord.patcher,cumcord.utils,cumcord.modules.common.React);
